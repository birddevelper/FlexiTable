var stringConstructor="test".constructor,arrayConstructor=[].constructor,objectConstructor={}.constructor;function removeItemFromArray(r,t){return r.filter((r=>r!==t))}function checkType(r){return null===r?"null":void 0===r?"undefined":r.constructor===stringConstructor?"String":r.constructor===arrayConstructor?"Array":r.constructor===objectConstructor?"Object":"Unknown"}function ExtractHeaders(r,t){for(var a=[],e=$("<tr/>"),n=$("<tr/>"),o=[],s=0;s<r.length;s++){var l=r[s];for(var c in l)if(-1==$.inArray(c,a))if(a.push(c),"Object"==checkType(l[c])){innerHeaderCount=0;var i=$("<th />");e.append(i.html(c));for(var u=0;u<r.length;u++)for(var d in r[u][c])r[u][c].hasOwnProperty(d)&&-1==$.inArray(c+","+d,a)&&(a.push(c+","+d),n.append($("<th />").html(d)),innerHeaderCount++);o.push(c),i.attr("colspan",innerHeaderCount)}else e.append($('<th rowspan="2" />').html(c))}for(var p in o)a=removeItemFromArray(a,o[p]);return $(t).append(e),$(t).append(n),console.log(a),a}function ArrayItemsSeperator(r,t){return"Array"==checkType(r)?r.join(t):r}function buildTable(r,t,a){for(var e=ExtractHeaders(r,t),n=0;n<r.length;n++){for(var o=$("<tr/>"),s=0;s<e.length;s++){var l=null;e[s].indexOf(",")>0?(fields=e[s].split(","),r[n][fields[0]]&&(l=ArrayItemsSeperator(r[n][fields[0]][fields[1]],a))):l=ArrayItemsSeperator(r[n][e[s]],a),null==l&&(l=""),o.append($("<td/>").html(l))}$(t).append(o)}}async function loadData(r){return jsonData=null,r.data?("Array"==checkType(r.data)?jsonData=r.data:"String"==checkType(r.data)&&(jsonData=await $.getJSON(r.data,(function(r){console.log("Data retrieved from url ")})).fail((function(){console.error("Can not retrieve json data from "+r.data)}))),jsonData):null}$.fn.jsonToHtmlTable=async function(r){var t;t=await loadData(r),r.tableCssClass||(r.tableCssClass=""),r.arraySeperator||(arraySeperator=", ");var a=$("<table/>");r.rtl&&a.attr("dir","rtl"),r.tableId&&a.attr("id",r.tableId),a.addClass(r.tableCssClass),buildTable(t,a,r.arraySeperator),this.html(a)};